var Socket=function(){var n=function(n){this.port=n,this._listen()},t=n.prototype;return t.port=null,t.io=null,t._rooms=[],t._events=[],t._bindings=[],t._listen=function(){this.io=require("socket.io").listen(this.port,{log:!1}),this._onConnection()},t._onConnection=function(){var n=this;this.io.on("connection",function(t){n._onDisconnect(t),n._onTriggerEvent(t),n._onJoinEvent(t),n._onLeaveEvent(t),n._onUnbindEvent(t)})},t._onDisconnect=function(n){n.on("disconnect",function(){})},t._onUnbindEvent=function(n){var t=this;n.on("FumePush:unbind",function(o){t.io.removeListener(o,function(){}),n.removeListener(o,function(){})})},t._onTriggerEvent=function(n){var t=this;n.on("Trigger:Event",function(o){o.isBroadcasting?t.broadcast(n,o):o.toAll?t._trigger(n,o,!0):t._trigger(n,o)})},t._onJoinEvent=function(n){var t=this;n.on("Join:Room",function(o){n.join(o);for(var i=0;i<t._rooms.length;i++)if(t._rooms[i]==o)return 0;t._rooms.push(o)})},t._onLeaveEvent=function(n){var t=this;n.on("Leave:Room",function(o){n.leave(o);for(var i=0;i<t._rooms.length;i++)if(t._rooms[i]==o)return t._rooms.splice(i,1)})},t._addEvent=function(n){this._events.push(n)},t._removeEvent=function(n){for(var t=0;t<this._events.length;t++)if(this._events[t]==n)return this._events.splice(t,1),this._removeEvent(n)},t._hasEvent=function(n){for(var t=0;t<this._events.length;t++)if(this._events[t]==n)return!0;return!1},t._trigger=function(n,t,o){o=o||!1,this._callBindings(n,t),o?this.io.sockets.emit(t.event,t):this.io.sockets.to(t.room).emit(t.event,t)},t.broadcast=function(n,t){n.broadcast.emit(t.event,t)},t.bind=function(n,t){this._bindings.push({event:n,cb:t})},t._callBindings=function(n,t){for(var o=0;o<this._bindings.length;o++)this._bindings[o].event===t.event&&this._bindings[o].cb.call(this,t)},t.trigger=function(n,t,o){o=o||"FumePush:PUBLIC",t={event:n,data:t,room:o},"FumePush:PUBLIC"!==o?this.io.sockets.to(o).emit(n,t):this.io.sockets.emit(n,t)},n}();module.exports=Socket;